============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0 -- /home/phil/opencode/memevolve/.venv/bin/python3
cachedir: .pytest_cache
rootdir: /home/phil/opencode/memevolve
configfile: pytest.ini
plugins: anyio-4.12.1, timeout-2.4.0
timeout: 600.0s
timeout method: signal
timeout func_only: False
collecting ... collected 392 items

src/tests/test_basic.py::test_basic_functionality PASSED                 [  0%]
src/tests/test_basic.py::test_math_operations PASSED                     [  0%]
src/tests/test_config.py::TestLLMConfig::test_default_values FAILED      [  0%]
src/tests/test_config.py::TestLLMConfig::test_custom_values FAILED       [  1%]
src/tests/test_config.py::TestStorageConfig::test_default_values PASSED  [  1%]
src/tests/test_config.py::TestStorageConfig::test_custom_values FAILED   [  1%]
src/tests/test_config.py::TestRetrievalConfig::test_default_values PASSED [  1%]
src/tests/test_config.py::TestRetrievalConfig::test_custom_values FAILED [  2%]
src/tests/test_config.py::TestManagementConfig::test_default_values PASSED [  2%]
src/tests/test_config.py::TestManagementConfig::test_custom_values FAILED [  2%]
src/tests/test_config.py::TestEncoderConfig::test_default_values PASSED  [  2%]
src/tests/test_config.py::TestEncoderConfig::test_custom_values FAILED   [  3%]
src/tests/test_config.py::TestEvolutionConfig::test_default_values PASSED [  3%]
src/tests/test_config.py::TestEvolutionConfig::test_custom_values FAILED [  3%]
src/tests/test_config.py::TestLoggingConfig::test_default_values FAILED  [  3%]
src/tests/test_config.py::TestLoggingConfig::test_custom_values FAILED   [  4%]
src/tests/test_config.py::TestMemEvolveConfig::test_default_values PASSED [  4%]
src/tests/test_config.py::TestConfigManager::test_initialization_no_file PASSED [  4%]
src/tests/test_config.py::TestConfigManager::test_initialization_with_invalid_path PASSED [  4%]
src/tests/test_config.py::TestConfigManager::test_load_from_yaml_file PASSED [  5%]
src/tests/test_config.py::TestConfigManager::test_load_from_json_file FAILED [  5%]
src/tests/test_config.py::TestConfigManager::test_update_config PASSED   [  5%]
src/tests/test_config.py::TestConfigManager::test_get_config_value PASSED [  5%]
src/tests/test_config.py::TestConfigManager::test_validate_config PASSED [  6%]
src/tests/test_config.py::TestConfigManager::test_to_dict PASSED         [  6%]
src/tests/test_config.py::TestConfigManager::test_save_to_yaml PASSED    [  6%]
src/tests/test_config.py::TestConfigManager::test_save_to_json FAILED    [  6%]
src/tests/test_config.py::TestLoadConfig::test_load_default_config PASSED [  7%]
src/tests/test_config.py::TestLoadConfig::test_load_from_file PASSED     [  7%]
src/tests/test_config.py::TestSaveConfig::test_save_config PASSED        [  7%]
src/tests/test_config.py::TestArchitecturePresets::test_agentkb_preset PASSED [  7%]
src/tests/test_config.py::TestArchitecturePresets::test_lightweight_preset PASSED [  8%]
src/tests/test_config.py::TestArchitecturePresets::test_riva_preset PASSED [  8%]
src/tests/test_config.py::TestArchitecturePresets::test_cerebra_preset PASSED [  8%]
src/tests/test_config.py::TestArchitecturePresets::test_unknown_architecture PASSED [  8%]
src/tests/test_data_io.py::test_memory_data_exporter_initialization PASSED [  9%]
src/tests/test_data_io.py::test_memory_data_importer_initialization PASSED [  9%]
src/tests/test_data_io.py::test_export_to_json PASSED                    [  9%]
src/tests/test_data_io.py::test_export_to_csv PASSED                     [  9%]
src/tests/test_data_io.py::test_export_by_type PASSED                    [ 10%]
src/tests/test_data_io.py::test_import_from_json PASSED                  [ 10%]
src/tests/test_data_io.py::test_import_from_csv PASSED                   [ 10%]
src/tests/test_data_io.py::test_import_skip_duplicates PASSED            [ 10%]
src/tests/test_data_io.py::test_convenience_functions PASSED             [ 11%]
src/tests/test_data_io.py::test_import_from_directory PASSED             [ 11%]
src/tests/test_debug_utils.py::test_memory_inspector_initialization PASSED [ 11%]
src/tests/test_debug_utils.py::test_memory_inspector_get_system_overview PASSED [ 11%]
src/tests/test_debug_utils.py::test_memory_inspector_inspect_memory_contents PASSED [ 12%]
src/tests/test_debug_utils.py::test_memory_inspector_inspect_memory_contents_with_content PASSED [ 12%]
src/tests/test_debug_utils.py::test_memory_inspector_analyze_component_states PASSED [ 12%]
src/tests/test_debug_utils.py::test_memory_inspector_find_similar_units PASSED [ 13%]
src/tests/test_debug_utils.py::test_memory_inspector_export_debug_report PASSED [ 13%]
src/tests/test_debug_utils.py::test_memory_debugger PASSED               [ 13%]
src/tests/test_debug_utils.py::test_convenience_functions PASSED         [ 13%]
src/tests/test_debug_utils.py::test_memory_inspector_error_handling PASSED [ 14%]
src/tests/test_diagnosis.py::test_trajectory_step_creation PASSED        [ 14%]
src/tests/test_diagnosis.py::test_diagnosis_engine_initialization PASSED [ 14%]
src/tests/test_diagnosis.py::test_analyze_successful_trajectory PASSED   [ 14%]
src/tests/test_diagnosis.py::test_analyze_failed_trajectory PASSED       [ 15%]
src/tests/test_diagnosis.py::test_failure_type_detection PASSED          [ 15%]
src/tests/test_diagnosis.py::test_diagnosis_report_to_dict PASSED        [ 15%]
src/tests/test_diagnosis.py::test_batch_analyze PASSED                   [ 15%]
src/tests/test_diagnosis.py::test_get_summary_statistics PASSED          [ 16%]
src/tests/test_diagnosis.py::test_confidence_calculation PASSED          [ 16%]
src/tests/test_diagnosis.py::test_trajectory_id_generation PASSED        [ 16%]
src/tests/test_encode.py::test_encoder_initialization PASSED             [ 16%]
src/tests/test_encode.py::test_encoder_client_not_initialized PASSED     [ 17%]
src/tests/test_encode.py::test_save_and_load_units PASSED                [ 17%]
src/tests/test_encode.py::test_load_nonexistent_file PASSED              [ 17%]
src/tests/test_encode.py::test_batch_encoding_trajectory PASSED          [ 17%]
src/tests/test_encode.py::test_tool_encoding_prompt_structure PASSED     [ 18%]
src/tests/test_encode.py::test_clean_llm_response PASSED                 [ 18%]
src/tests/test_encoding_metrics.py::test_encoding_metrics_initialization PASSED [ 18%]
src/tests/test_encoding_metrics.py::test_encoding_metrics_calculate_success_rate PASSED [ 18%]
src/tests/test_encoding_metrics.py::test_encoding_metrics_calculate_average_time PASSED [ 19%]
src/tests/test_encoding_metrics.py::test_encoding_metrics_calculate_with_zero_encodings PASSED [ 19%]
src/tests/test_encoding_metrics.py::test_metrics_collector_initialization PASSED [ 19%]
src/tests/test_encoding_metrics.py::test_metrics_collector_start_encoding PASSED [ 19%]
src/tests/test_encoding_metrics.py::test_metrics_collector_end_successful_encoding PASSED [ 20%]
src/tests/test_encoding_metrics.py::test_metrics_collector_end_failed_encoding PASSED [ 20%]
src/tests/test_encoding_metrics.py::test_metrics_collector_multiple_encodings PASSED [ 20%]
src/tests/test_encoding_metrics.py::test_metrics_collector_type_distribution PASSED [ 20%]
src/tests/test_encoding_metrics.py::test_metrics_collector_error_categorization PASSED [ 21%]
src/tests/test_encoding_metrics.py::test_metrics_collector_get_metrics PASSED [ 21%]
src/tests/test_encoding_metrics.py::test_metrics_collector_get_encoding_history PASSED [ 21%]
src/tests/test_encoding_metrics.py::test_metrics_collector_clear_history PASSED [ 21%]
src/tests/test_encoding_metrics.py::test_metrics_collector_reset_metrics PASSED [ 22%]
src/tests/test_encoding_metrics.py::test_metrics_collector_get_summary PASSED [ 22%]
src/tests/test_experiment_runner.py::test_experiment_runner_initialization PASSED [ 22%]
src/tests/test_experiment_runner.py::test_baseline_experiment PASSED     [ 22%]
src/tests/test_experiment_runner.py::test_single_experiment PASSED       [ 23%]
src/tests/test_experiment_runner.py::test_experiment_summary_generation PASSED [ 23%]
src/tests/test_experiment_runner.py::test_get_reference_architectures PASSED [ 23%]
src/tests/test_fixture_tests.py::test_assert_memory_unit_structure PASSED [ 23%]
src/tests/test_fixture_tests.py::test_assert_memory_units_unique PASSED  [ 24%]
src/tests/test_fixture_tests.py::test_assert_memory_system_health PASSED [ 24%]
src/tests/test_fixture_tests.py::test_count_units_by_type PASSED         [ 24%]
src/tests/test_fixture_tests.py::test_count_units_by_category PASSED     [ 25%]
src/tests/test_fixture_tests.py::test_sample_memory_units_fixture PASSED [ 25%]
src/tests/test_fixture_tests.py::test_large_memory_units_fixture PASSED  [ 25%]
src/tests/test_fixture_tests.py::test_diverse_memory_units_fixture PASSED [ 25%]
src/tests/test_fixture_tests.py::test_sample_experience_fixture PASSED   [ 26%]
src/tests/test_fixture_tests.py::test_test_scenario_fixture PASSED       [ 26%]
src/tests/test_fixture_tests.py::test_basic_memory_config_fixture PASSED [ 26%]
src/tests/test_fixture_tests.py::test_memory_system_config_fixture PASSED [ 26%]
src/tests/test_fixture_tests.py::test_json_store_fixture PASSED          [ 27%]
src/tests/test_fixture_tests.py::test_populated_json_store_fixture PASSED [ 27%]
src/tests/test_fixture_tests.py::test_experience_encoder_fixture PASSED  [ 27%]
src/tests/test_fixture_tests.py::test_semantic_retriever_fixture PASSED  [ 27%]
src/tests/test_fixture_tests.py::test_simple_memory_manager_fixture PASSED [ 28%]
src/tests/test_fixture_tests.py::test_basic_memory_system_fixture PASSED [ 28%]
src/tests/test_fixture_tests.py::test_populated_memory_system_fixture PASSED [ 28%]
src/tests/test_fixture_tests.py::test_programming_focused_units_fixture PASSED [ 28%]
src/tests/test_fixture_tests.py::test_ai_focused_units_fixture PASSED    [ 29%]
src/tests/test_fixture_tests.py::test_mixed_category_units_fixture PASSED [ 29%]
src/tests/test_fixture_tests.py::test_edge_case_units_fixture PASSED     [ 29%]
src/tests/test_fixture_tests.py::test_performance_test_units_fixture PASSED [ 29%]
src/tests/test_fixture_tests.py::test_retrieval_test_setup_fixture PASSED [ 30%]
src/tests/test_fixture_tests.py::test_encoding_test_setup_fixture PASSED [ 30%]
src/tests/test_fixture_tests.py::test_management_test_setup_fixture PASSED [ 30%]
src/tests/test_fixture_tests.py::test_integration_test_setup_fixture ERROR [ 30%]
src/tests/test_genotype.py::test_genotype_creation PASSED                [ 31%]
src/tests/test_genotype.py::test_genome_id PASSED                        [ 31%]
src/tests/test_genotype.py::test_factory_baseline PASSED                 [ 31%]
src/tests/test_genotype.py::test_factory_agentkb PASSED                  [ 31%]
src/tests/test_genotype.py::test_factory_lightweight PASSED              [ 32%]
src/tests/test_genotype.py::test_factory_riva PASSED                     [ 32%]
src/tests/test_genotype.py::test_factory_cerebra PASSED                  [ 32%]
src/tests/test_genotype.py::test_genotype_serialization PASSED           [ 32%]
src/tests/test_genotype.py::test_genotype_mutation PASSED                [ 33%]
src/tests/test_graph_store.py::test_graph_backend_initialization PASSED  [ 33%]
src/tests/test_graph_store.py::test_store_single_unit PASSED             [ 33%]
src/tests/test_graph_store.py::test_retrieve_stored_unit PASSED          [ 33%]
src/tests/test_graph_store.py::test_retrieve_nonexistent_unit PASSED     [ 34%]
src/tests/test_graph_store.py::test_store_batch_units PASSED             [ 34%]
src/tests/test_graph_store.py::test_update_unit PASSED                   [ 34%]
src/tests/test_graph_store.py::test_update_nonexistent_unit PASSED       [ 34%]
src/tests/test_graph_store.py::test_delete_unit PASSED                   [ 35%]
src/tests/test_graph_store.py::test_delete_nonexistent_unit PASSED       [ 35%]
src/tests/test_graph_store.py::test_exists_check PASSED                  [ 35%]
src/tests/test_graph_store.py::test_count_units PASSED                   [ 35%]
src/tests/test_graph_store.py::test_retrieve_all_units PASSED            [ 36%]
src/tests/test_graph_store.py::test_clear_storage PASSED                 [ 36%]
src/tests/test_graph_store.py::test_query_related_units PASSED           [ 36%]
src/tests/test_graph_store.py::test_get_graph_stats PASSED               [ 36%]
src/tests/test_graph_store.py::test_deduplication PASSED                 [ 37%]
src/tests/test_graph_store.py::test_different_content_same_id PASSED     [ 37%]
src/tests/test_hybrid_strategy.py::test_hybrid_initialization PASSED     [ 37%]
src/tests/test_hybrid_strategy.py::test_retrieve_with_query PASSED       [ 38%]
src/tests/test_hybrid_strategy.py::test_retrieve_with_top_k PASSED       [ 38%]
src/tests/test_hybrid_strategy.py::test_retrieve_with_different_weights PASSED [ 38%]
src/tests/test_hybrid_strategy.py::test_set_weights PASSED               [ 38%]
src/tests/test_hybrid_strategy.py::test_set_weights_normalization PASSED [ 39%]
src/tests/test_hybrid_strategy.py::test_set_weights_zero_total PASSED    [ 39%]
src/tests/test_hybrid_strategy.py::test_retrieve_by_ids PASSED           [ 39%]
src/tests/test_hybrid_strategy.py::test_search PASSED                    [ 39%]
src/tests/test_hybrid_strategy.py::test_count_relevant PASSED            [ 40%]
src/tests/test_hybrid_strategy.py::test_retrieve_with_filters PASSED     [ 40%]
src/tests/test_hybrid_strategy.py::test_hybrid_scoring PASSED            [ 40%]
src/tests/test_hybrid_strategy.py::test_combine_results_unique PASSED    [ 40%]
src/tests/test_hybrid_strategy.py::test_combine_results_semantic_only PASSED [ 41%]
src/tests/test_hybrid_strategy.py::test_combine_results_keyword_only PASSED [ 41%]
src/tests/test_json_store.py::test_json_store_initialization PASSED      [ 41%]
src/tests/test_json_store.py::test_store_and_retrieve PASSED             [ 41%]
src/tests/test_json_store.py::test_store_with_explicit_id PASSED         [ 42%]
src/tests/test_json_store.py::test_store_batch PASSED                    [ 42%]
src/tests/test_json_store.py::test_update PASSED                         [ 42%]
src/tests/test_json_store.py::test_update_nonexistent PASSED             [ 42%]
src/tests/test_json_store.py::test_delete PASSED                         [ 43%]
src/tests/test_json_store.py::test_delete_nonexistent PASSED             [ 43%]
src/tests/test_json_store.py::test_exists PASSED                         [ 43%]
src/tests/test_json_store.py::test_count PASSED                          [ 43%]
src/tests/test_json_store.py::test_clear PASSED                          [ 44%]
src/tests/test_json_store.py::test_retrieve_all PASSED                   [ 44%]
src/tests/test_json_store.py::test_get_metadata PASSED                   [ 44%]
src/tests/test_json_store.py::test_persistence PASSED                    [ 44%]
src/tests/test_json_store.py::test_load_existing_file PASSED             [ 45%]
src/tests/test_keyword_strategy.py::test_strategy_initialization PASSED  [ 45%]
src/tests/test_keyword_strategy.py::test_retrieve_with_query PASSED      [ 45%]
src/tests/test_keyword_strategy.py::test_retrieve_with_top_k PASSED      [ 45%]
src/tests/test_keyword_strategy.py::test_retrieve_with_no_matches PASSED [ 46%]
src/tests/test_keyword_strategy.py::test_retrieve_by_ids PASSED          [ 46%]
src/tests/test_keyword_strategy.py::test_retrieve_by_ids_nonexistent PASSED [ 46%]
src/tests/test_keyword_strategy.py::test_search PASSED                   [ 46%]
src/tests/test_keyword_strategy.py::test_count_relevant PASSED           [ 47%]
src/tests/test_keyword_strategy.py::test_count_relevant_no_matches PASSED [ 47%]
src/tests/test_keyword_strategy.py::test_retrieve_with_filters PASSED    [ 47%]
src/tests/test_keyword_strategy.py::test_case_sensitive_retrieval PASSED [ 47%]
src/tests/test_keyword_strategy.py::test_scoring PASSED                  [ 48%]
src/tests/test_keyword_strategy.py::test_tag_matching PASSED             [ 48%]
src/tests/test_keyword_strategy.py::test_metadata_in_results PASSED      [ 48%]
src/tests/test_keyword_strategy.py::test_multiple_keywords PASSED        [ 48%]
src/tests/test_keyword_strategy.py::test_empty_query PASSED              [ 49%]
src/tests/test_keyword_strategy.py::test_short_terms_filtered PASSED     [ 49%]
src/tests/test_llm_guided_retrieval.py::test_llm_guided_retrieval_initialization PASSED [ 49%]
src/tests/test_llm_guided_retrieval.py::test_retrieval_guidance_generation PASSED [ 50%]
src/tests/test_llm_guided_retrieval.py::test_llm_guided_retrieve PASSED  [ 50%]
src/tests/test_llm_guided_retrieval.py::test_enhance_filters PASSED      [ 50%]
src/tests/test_llm_guided_retrieval.py::test_llm_reranking PASSED        [ 50%]
src/tests/test_llm_guided_retrieval.py::test_retrieve_by_ids_delegation PASSED [ 51%]
src/tests/test_llm_guided_retrieval.py::test_fallback_on_llm_failure PASSED [ 51%]
src/tests/test_logging.py::TestOperationLogger::test_initialization PASSED [ 51%]
src/tests/test_logging.py::TestOperationLogger::test_initialization_disabled PASSED [ 51%]
src/tests/test_logging.py::TestOperationLogger::test_initialization_custom_max PASSED [ 52%]
src/tests/test_logging.py::TestOperationLogger::test_log_operation PASSED [ 52%]
src/tests/test_logging.py::TestOperationLogger::test_log_disabled PASSED [ 52%]
src/tests/test_logging.py::TestOperationLogger::test_log_with_metadata PASSED [ 52%]
src/tests/test_logging.py::TestOperationLogger::test_max_entries_limit PASSED [ 53%]
src/tests/test_logging.py::TestOperationLogger::test_get_operations_all PASSED [ 53%]
src/tests/test_logging.py::TestOperationLogger::test_get_operations_filtered PASSED [ 53%]
src/tests/test_logging.py::TestOperationLogger::test_get_operations_with_limit PASSED [ 53%]
src/tests/test_logging.py::TestOperationLogger::test_get_operations_filtered_with_limit PASSED [ 54%]
src/tests/test_logging.py::TestOperationLogger::test_get_stats_empty PASSED [ 54%]
src/tests/test_logging.py::TestOperationLogger::test_get_stats_with_operations PASSED [ 54%]
src/tests/test_logging.py::TestOperationLogger::test_clear PASSED        [ 54%]
src/tests/test_logging.py::TestOperationLogger::test_export PASSED       [ 55%]
src/tests/test_logging.py::TestSetupLogging::test_setup_default PASSED   [ 55%]
src/tests/test_logging.py::TestSetupLogging::test_setup_with_level PASSED [ 55%]
src/tests/test_logging.py::TestSetupLogging::test_setup_with_file PASSED [ 55%]
src/tests/test_logging.py::TestSetupLogging::test_setup_custom_format PASSED [ 56%]
src/tests/test_logging.py::TestSetupLogging::test_setup_invalid_level PASSED [ 56%]
src/tests/test_logging.py::TestGetLogger::test_get_logger_instance PASSED [ 56%]
src/tests/test_logging.py::TestGetLogger::test_get_logger_same_instance PASSED [ 56%]
src/tests/test_logging.py::TestConfigureFromConfig::test_configure_from_dict PASSED [ 57%]
src/tests/test_logging.py::TestConfigureFromConfig::test_configure_with_file PASSED [ 57%]
src/tests/test_logging.py::TestStructuredLogger::test_initialization PASSED [ 57%]
src/tests/test_logging.py::TestStructuredLogger::test_log_with_context PASSED [ 57%]
src/tests/test_logging.py::TestStructuredLogger::test_debug PASSED       [ 58%]
src/tests/test_logging.py::TestStructuredLogger::test_info PASSED        [ 58%]
src/tests/test_logging.py::TestStructuredLogger::test_warning PASSED     [ 58%]
src/tests/test_logging.py::TestStructuredLogger::test_error PASSED       [ 58%]
src/tests/test_logging.py::TestStructuredLogger::test_critical PASSED    [ 59%]
src/tests/test_logging.py::TestStructuredLogger::test_log_no_context PASSED [ 59%]
src/tests/test_logging.py::TestStructuredLogger::test_log_with_context_formats PASSED [ 59%]
src/tests/test_manage_base.py::test_health_metrics_creation PASSED       [ 59%]
src/tests/test_manage_base.py::test_memory_manager_initialization PASSED [ 60%]
src/tests/test_manage_base.py::test_set_strategy PASSED                  [ 60%]
src/tests/test_manage_base.py::test_prune PASSED                         [ 60%]
src/tests/test_manage_base.py::test_consolidate PASSED                   [ 60%]
src/tests/test_manage_base.py::test_deduplicate PASSED                   [ 61%]
src/tests/test_manage_base.py::test_apply_forgetting PASSED              [ 61%]
src/tests/test_manage_base.py::test_get_health_metrics PASSED            [ 61%]
src/tests/test_manage_base.py::test_operation_history PASSED             [ 61%]
src/tests/test_manage_base.py::test_clear_history PASSED                 [ 62%]
src/tests/test_manage_base.py::test_prune_affects_storage PASSED         [ 62%]
src/tests/test_memory_system.py::test_memory_system_initialization PASSED [ 62%]
src/tests/test_memory_system.py::test_memory_system_default_config PASSED [ 63%]
src/tests/test_memory_system.py::test_add_experience PASSED              [ 63%]
src/tests/test_memory_system.py::test_add_trajectory PASSED              [ 63%]
src/tests/test_memory_system.py::test_query_memory PASSED                [ 63%]
src/tests/test_memory_system.py::test_query_memory_with_filters PASSED   [ 64%]
src/tests/test_memory_system.py::test_retrieve_by_ids PASSED             [ 64%]
src/tests/test_memory_system.py::test_generate_abstraction FAILED        [ 64%]
src/tests/test_memory_system.py::test_manage_prune FAILED                [ 64%]
src/tests/test_memory_system.py::test_manage_consolidate FAILED          [ 65%]
src/tests/test_memory_system.py::test_manage_deduplicate PASSED          [ 65%]
src/tests/test_memory_system.py::test_manage_forget PASSED               [ 65%]
src/tests/test_memory_system.py::test_get_health_metrics PASSED          [ 65%]
src/tests/test_memory_system.py::test_get_health_metrics_without_manager PASSED [ 66%]
src/tests/test_memory_system.py::test_operation_log PASSED               [ 66%]
src/tests/test_memory_system.py::test_clear_operation_log PASSED         [ 66%]
src/tests/test_memory_system.py::test_auto_management_enabled PASSED     [ 66%]
src/tests/test_memory_system.py::test_auto_management_disabled PASSED    [ 67%]
src/tests/test_memory_system.py::test_callbacks PASSED                   [ 67%]
src/tests/test_memory_system.py::test_error_handling_add_experience PASSED [ 67%]
src/tests/test_memory_system.py::test_error_handling_query_memory PASSED [ 67%]
src/tests/test_metrics.py::test_system_metrics_initialization PASSED     [ 68%]
src/tests/test_metrics.py::test_system_metrics_calculate_overall_success_rate PASSED [ 68%]
src/tests/test_metrics.py::test_system_metrics_get_performance_summary PASSED [ 68%]
src/tests/test_metrics.py::test_metrics_collector_initialization PASSED  [ 68%]
src/tests/test_metrics.py::test_metrics_collector_collect_from_memory_system PASSED [ 69%]
src/tests/test_metrics.py::test_metrics_collector_snapshot PASSED        [ 69%]
src/tests/test_metrics.py::test_metrics_collector_analyze_trends PASSED  [ 69%]
src/tests/test_metrics.py::test_metrics_collector_analyze_trends_insufficient_data PASSED [ 69%]
src/tests/test_metrics.py::test_metrics_collector_export_to_json PASSED  [ 70%]
src/tests/test_metrics.py::test_metrics_collector_export_to_csv PASSED   [ 70%]
src/tests/test_metrics.py::test_metrics_collector_reset PASSED           [ 70%]
src/tests/test_metrics.py::test_metrics_collector_get_summary_report PASSED [ 70%]
src/tests/test_metrics.py::test_metrics_collector_empty_history_summary PASSED [ 71%]
src/tests/test_mock_generators.py::test_memory_unit_generator_initialization PASSED [ 71%]
src/tests/test_mock_generators.py::test_memory_unit_generator_generate_unit PASSED [ 71%]
src/tests/test_mock_generators.py::test_memory_unit_generator_generate_unit_with_type PASSED [ 71%]
src/tests/test_mock_generators.py::test_memory_unit_generator_generate_unit_with_category PASSED [ 72%]
src/tests/test_mock_generators.py::test_memory_unit_generator_generate_units PASSED [ 72%]
src/tests/test_mock_generators.py::test_memory_unit_generator_generate_units_with_constraints PASSED [ 72%]
src/tests/test_mock_generators.py::test_experience_generator_initialization PASSED [ 72%]
src/tests/test_mock_generators.py::test_experience_generator_generate_experience PASSED [ 73%]
src/tests/test_mock_generators.py::test_experience_generator_generate_experience_with_size PASSED [ 73%]
src/tests/test_mock_generators.py::test_experience_generator_generate_experience_batch PASSED [ 73%]
src/tests/test_mock_generators.py::test_test_scenario_generator_initialization PASSED [ 73%]
src/tests/test_mock_generators.py::test_test_scenario_generator_basic_scenario PASSED [ 74%]
src/tests/test_mock_generators.py::test_test_scenario_generator_complex_scenario PASSED [ 74%]
src/tests/test_mock_generators.py::test_test_scenario_generator_performance_scenario PASSED [ 74%]
src/tests/test_mock_generators.py::test_test_scenario_generator_edge_case_scenario PASSED [ 75%]
src/tests/test_mock_generators.py::test_convenience_functions PASSED     [ 75%]
src/tests/test_mock_generators.py::test_memory_unit_generator_deterministic_with_seed PASSED [ 75%]
src/tests/test_mock_generators.py::test_memory_unit_generator_different_results_without_seed PASSED [ 75%]
src/tests/test_mock_generators.py::test_experience_generator_with_custom_unit_generator PASSED [ 76%]
src/tests/test_mutation.py::test_random_mutation_strategy_initialization PASSED [ 76%]
src/tests/test_mutation.py::test_random_mutation_mutate PASSED           [ 76%]
src/tests/test_mutation.py::test_random_mutation_no_mutation PASSED      [ 76%]
src/tests/test_mutation.py::test_targeted_mutation_strategy_initialization PASSED [ 77%]
src/tests/test_mutation.py::test_targeted_mutation_mutate PASSED         [ 77%]
src/tests/test_mutation.py::test_mutation_engine_initialization PASSED   [ 77%]
src/tests/test_mutation.py::test_mutation_engine_mutate PASSED           [ 77%]
src/tests/test_mutation.py::test_mutation_operation_creation PASSED      [ 78%]
src/tests/test_mutation.py::test_mutation_engine_track_mutations PASSED  [ 78%]
src/tests/test_mutation.py::test_mutation_engine_batch_mutate PASSED     [ 78%]
src/tests/test_mutation.py::test_targeted_mutation_adjusts_rates PASSED  [ 78%]
src/tests/test_mutation.py::test_mutation_result_failure_handling PASSED [ 79%]
src/tests/test_mutation.py::test_mutation_with_custom_strategy PASSED    [ 79%]
src/tests/test_mutation.py::test_mutation_preserves_metadata PASSED      [ 79%]
src/tests/test_mutation.py::test_mutation_generates_different_genome_ids PASSED [ 79%]
src/tests/test_profiling.py::test_memory_profiler_initialization PASSED  [ 80%]
src/tests/test_profiling.py::test_profile_operation_context_manager PASSED [ 80%]
src/tests/test_profiling.py::test_profile_function PASSED                [ 80%]
src/tests/test_profiling.py::test_profile_memory_system_operation PASSED [ 80%]
src/tests/test_profiling.py::test_generate_report_empty PASSED           [ 81%]
src/tests/test_profiling.py::test_generate_report_with_data PASSED       [ 81%]
src/tests/test_profiling.py::test_clear_results PASSED                   [ 81%]
src/tests/test_profiling.py::test_export_profile_stats PASSED            [ 81%]
src/tests/test_profiling.py::test_run_benchmark PASSED                   [ 82%]
src/tests/test_profiling.py::test_convenience_functions PASSED           [ 82%]
src/tests/test_profiling.py::test_profile_result_to_dict PASSED          [ 82%]
src/tests/test_profiling.py::test_performance_report_to_dict PASSED      [ 82%]
src/tests/test_retrieve_base.py::test_retrieval_result_creation PASSED   [ 83%]
src/tests/test_retrieve_base.py::test_retrieval_context_initialization PASSED [ 83%]
src/tests/test_retrieve_base.py::test_retrieve_with_context PASSED       [ 83%]
src/tests/test_retrieve_base.py::test_retrieve_with_custom_top_k PASSED  [ 83%]
src/tests/test_retrieve_base.py::test_retrieve_by_ids PASSED             [ 84%]
src/tests/test_retrieve_base.py::test_search PASSED                      [ 84%]
src/tests/test_retrieve_base.py::test_count_relevant PASSED              [ 84%]
src/tests/test_retrieve_base.py::test_retrieval_history PASSED           [ 84%]
src/tests/test_retrieve_base.py::test_clear_history PASSED               [ 85%]
src/tests/test_retrieve_base.py::test_set_strategy PASSED                [ 85%]
src/tests/test_selection.py::test_fitness_metrics_creation PASSED        [ 85%]
src/tests/test_selection.py::test_fitness_metrics_default_weights PASSED [ 85%]
src/tests/test_selection.py::test_evaluation_result_creation PASSED      [ 86%]
src/tests/test_selection.py::test_evaluation_result_domination PASSED    [ 86%]
src/tests/test_selection.py::test_pareto_selector_initialization PASSED  [ 86%]
src/tests/test_selection.py::test_pareto_selector_custom_weights PASSED  [ 86%]
src/tests/test_selection.py::test_pareto_selector_backend_costs PASSED   [ 87%]
src/tests/test_selection.py::test_pareto_selector_strategy_costs PASSED  [ 87%]
src/tests/test_selection.py::test_pareto_selector_all_backends_strategies PASSED [ 87%]
src/tests/test_selection.py::test_pareto_selector_evaluate PASSED        [ 88%]
src/tests/test_selection.py::test_pareto_selector_pareto_front PASSED    [ 88%]
src/tests/test_selection.py::test_pareto_selector_select_best PASSED     [ 88%]
src/tests/test_selection.py::test_pareto_selector_select_top_n PASSED    [ 88%]
src/tests/test_selection.py::test_pareto_selector_empty_results PASSED   [ 89%]
src/tests/test_selection.py::test_pareto_selector_calculate_cost PASSED  [ 89%]
src/tests/test_selection.py::test_pareto_selector_storage_efficiency PASSED [ 89%]
src/tests/test_semantic_strategy.py::test_strategy_initialization PASSED [ 89%]
src/tests/test_semantic_strategy.py::test_retrieve_with_query PASSED     [ 90%]
src/tests/test_semantic_strategy.py::test_retrieve_with_top_k PASSED     [ 90%]
src/tests/test_semantic_strategy.py::test_retrieve_with_similarity_threshold PASSED [ 90%]
src/tests/test_semantic_strategy.py::test_retrieve_with_no_matches PASSED [ 90%]
src/tests/test_semantic_strategy.py::test_retrieve_by_ids PASSED         [ 91%]
src/tests/test_semantic_strategy.py::test_retrieve_by_ids_nonexistent PASSED [ 91%]
src/tests/test_semantic_strategy.py::test_search PASSED                  [ 91%]
src/tests/test_semantic_strategy.py::test_count_relevant PASSED          [ 91%]
src/tests/test_semantic_strategy.py::test_retrieve_with_filters PASSED   [ 92%]
src/tests/test_semantic_strategy.py::test_scoring PASSED                 [ 92%]
src/tests/test_semantic_strategy.py::test_embedding_caching PASSED       [ 92%]
src/tests/test_semantic_strategy.py::test_clear_cache PASSED             [ 92%]
src/tests/test_semantic_strategy.py::test_cosine_similarity PASSED       [ 93%]
src/tests/test_semantic_strategy.py::test_unit_to_text PASSED            [ 93%]
src/tests/test_semantic_strategy.py::test_create_embedding_function PASSED [ 93%]
src/tests/test_semantic_strategy.py::test_create_embedding_function_with_custom_dim PASSED [ 93%]
src/tests/test_simple_strategy.py::test_prune_by_type PASSED             [ 94%]
src/tests/test_simple_strategy.py::test_prune_by_max_count PASSED        [ 94%]
src/tests/test_simple_strategy.py::test_prune_no_criteria PASSED         [ 94%]
src/tests/test_simple_strategy.py::test_consolidate PASSED               [ 94%]
src/tests/test_simple_strategy.py::test_consolidate_by_ids PASSED        [ 95%]
src/tests/test_simple_strategy.py::test_deduplicate PASSED               [ 95%]
src/tests/test_simple_strategy.py::test_deduplicate_no_duplicates PASSED [ 95%]
src/tests/test_simple_strategy.py::test_apply_forgetting_lru PASSED      [ 95%]
src/tests/test_simple_strategy.py::test_apply_forgetting_random PASSED   [ 96%]
src/tests/test_simple_strategy.py::test_apply_forgetting_auto_count PASSED [ 96%]
src/tests/test_simple_strategy.py::test_get_health_metrics PASSED        [ 96%]
src/tests/test_simple_strategy.py::test_health_metrics_type_distribution PASSED [ 96%]
src/tests/test_simple_strategy.py::test_health_metrics_duplicates PASSED [ 97%]
src/tests/test_simple_strategy.py::test_health_metrics_empty_storage PASSED [ 97%]
src/tests/test_simple_strategy.py::test_prune_by_max_age PASSED          [ 97%]
src/tests/test_store_base.py::test_store_and_retrieve PASSED             [ 97%]
src/tests/test_store_base.py::test_store_batch PASSED                    [ 98%]
src/tests/test_store_base.py::test_update PASSED                         [ 98%]
src/tests/test_store_base.py::test_delete PASSED                         [ 98%]
src/tests/test_store_base.py::test_exists PASSED                         [ 98%]
src/tests/test_store_base.py::test_count PASSED                          [ 99%]
src/tests/test_store_base.py::test_clear PASSED                          [ 99%]
src/tests/test_store_base.py::test_retrieve_all PASSED                   [ 99%]
src/tests/test_store_base.py::test_get_metadata PASSED                   [100%]

==================================== ERRORS ====================================
____________ ERROR at setup of test_integration_test_setup_fixture _____________

self = <components.encode.encoder.ExperienceEncoder object at 0x7fb80376ef30>
experience = {'content': 'Abstracting real-world cases leads to visualizationConcept_14 which enables problem solving.', 'id': 'abs...41.101852+00:00Z', 'source': 'mock_generated'}, 'tags': ['data', 'data analysis', 'visualization', 'proficiency'], ...}

    def encode_experience(self, experience: Dict[str, Any]) -> Dict[str, Any]:
        if self.client is None:
            raise RuntimeError(
                "LLM client not initialized. Call initialize_llm() first.")
    
        experience_id = experience.get("id", "unknown")
        operation_id = self.metrics_collector.start_encoding(experience_id)
        start_time = time.time()
    
        prompt = (
            "Transform this raw experience into a structured knowledge "
            "unit:\n\n"
            f"Experience:\n{json.dumps(experience, indent=2)}\n\n"
            "Format your response as JSON with these fields:\n"
            '- "type": "lesson" (generalizable insight), "skill" (actionable technique), '
            '"tool" (reusable function/algorithm), "abstraction" (high-level concept)\n'
            '- "content": The transformed content\n'
            '- "metadata": Additional relevant metadata (for tools: include parameters, usage, etc.)\n'
            '- "tags": Relevant tags for retrieval\n\n'
            "For tools, focus on extracting reusable functionality that can be applied to similar problems.\n\n"
            "Example output formats:\n"
            '{\n  "type": "lesson",\n  "content": "Always validate input data before processing",\n  '
            '"metadata": {},\n  "tags": ["data-validation", "best-practices"]\n}\n\n'
            '{\n  "type": "tool",\n  "content": "Binary search algorithm for finding elements in sorted arrays",\n  '
            '"metadata": {"parameters": ["array", "target"], "complexity": "O(log n)"},\n  '
            '"tags": ["algorithm", "search", "binary-search"]\n}'
        )
    
        try:
            kwargs = {
                "messages": [{"role": "user", "content": prompt}],
                "max_tokens": 512,
                "temperature": 0.7,
                "timeout": 300.0
            }
    
            if self.model is not None:
                kwargs["model"] = self.model
    
            response = self.client.chat.completions.create(**kwargs)
            content = response.choices[0].message.content
            if content is None:
                raise RuntimeError("Empty response from LLM")
    
            # Clean up the response to extract JSON
            cleaned_content = self._clean_llm_response(content)
>           structured_data = json.loads(cleaned_content)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^

src/components/encode/encoder.py:168: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/usr/lib/python3.12/json/__init__.py:346: in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <json.decoder.JSONDecoder object at 0x7fb81f29fce0>
s = '{\n  "type": "lesson",\n  "content": "Abstracting real-world cases leads to visualizationConcept_14 which enables pro...5242524,\n    "source": "mock_generated"\n  },\n  "tags": ["data", "data analysis", "visualization", "proficiency"]\n}'
_w = <built-in method match of re.Pattern object at 0x7fb81f2569b0>

    def decode(self, s, _w=WHITESPACE.match):
        """Return the Python representation of ``s`` (a ``str`` instance
        containing a JSON document).
    
        """
        obj, end = self.raw_decode(s, idx=_w(s, 0).end())
        end = _w(s, end).end()
        if end != len(s):
>           raise JSONDecodeError("Extra data", s, end)
E           json.decoder.JSONDecodeError: Extra data: line 8 column 1 (char 317)

/usr/lib/python3.12/json/decoder.py:340: JSONDecodeError

During handling of the above exception, another exception occurred:

self = <memory_system.MemorySystem object at 0x7fb80371efc0>
experience = {'content': 'Abstracting real-world cases leads to visualizationConcept_14 which enables problem solving.', 'id': 'abs...41.101852+00:00Z', 'source': 'mock_generated'}, 'tags': ['data', 'data analysis', 'visualization', 'proficiency'], ...}

    def add_experience(self, experience: Dict[str, Any]) -> str:
        """Add a single experience to memory.
    
        This method processes a raw experience through the encoding pipeline,
        transforms it into a structured memory unit, and stores it for future retrieval.
    
        Args:
            experience: Dictionary containing experience data. Common fields:
                - "action": What was done (e.g., "searched database")
                - "result": What happened (e.g., "found relevant records")
                - "context": Additional context information
                - "timestamp": When the experience occurred
                - "metadata": Any additional relevant data
    
        Returns:
            The unique ID of the stored memory unit
    
        Raises:
            RuntimeError: If encoder or storage components are not initialized
    
        Example:
            >>> experience = {
            ...     "action": "debug code",
            ...     "result": "found null pointer exception",
            ...     "context": "C++ application",
            ...     "timestamp": "2024-01-01T10:00:00Z"
            ... }
            >>> unit_id = memory.add_experience(experience)
            >>> print(f"Stored memory unit: {unit_id}")
        """
        try:
            if not self.encoder or not self.storage:
                raise RuntimeError(
                    "Encoder and storage must be initialized"
                )
    
>           encoded_unit = self.encoder.encode_experience(experience)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

src/memory_system.py:287: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <components.encode.encoder.ExperienceEncoder object at 0x7fb80376ef30>
experience = {'content': 'Abstracting real-world cases leads to visualizationConcept_14 which enables problem solving.', 'id': 'abs...41.101852+00:00Z', 'source': 'mock_generated'}, 'tags': ['data', 'data analysis', 'visualization', 'proficiency'], ...}

    def encode_experience(self, experience: Dict[str, Any]) -> Dict[str, Any]:
        if self.client is None:
            raise RuntimeError(
                "LLM client not initialized. Call initialize_llm() first.")
    
        experience_id = experience.get("id", "unknown")
        operation_id = self.metrics_collector.start_encoding(experience_id)
        start_time = time.time()
    
        prompt = (
            "Transform this raw experience into a structured knowledge "
            "unit:\n\n"
            f"Experience:\n{json.dumps(experience, indent=2)}\n\n"
            "Format your response as JSON with these fields:\n"
            '- "type": "lesson" (generalizable insight), "skill" (actionable technique), '
            '"tool" (reusable function/algorithm), "abstraction" (high-level concept)\n'
            '- "content": The transformed content\n'
            '- "metadata": Additional relevant metadata (for tools: include parameters, usage, etc.)\n'
            '- "tags": Relevant tags for retrieval\n\n'
            "For tools, focus on extracting reusable functionality that can be applied to similar problems.\n\n"
            "Example output formats:\n"
            '{\n  "type": "lesson",\n  "content": "Always validate input data before processing",\n  '
            '"metadata": {},\n  "tags": ["data-validation", "best-practices"]\n}\n\n'
            '{\n  "type": "tool",\n  "content": "Binary search algorithm for finding elements in sorted arrays",\n  '
            '"metadata": {"parameters": ["array", "target"], "complexity": "O(log n)"},\n  '
            '"tags": ["algorithm", "search", "binary-search"]\n}'
        )
    
        try:
            kwargs = {
                "messages": [{"role": "user", "content": prompt}],
                "max_tokens": 512,
                "temperature": 0.7,
                "timeout": 300.0
            }
    
            if self.model is not None:
                kwargs["model"] = self.model
    
            response = self.client.chat.completions.create(**kwargs)
            content = response.choices[0].message.content
            if content is None:
                raise RuntimeError("Empty response from LLM")
    
            # Clean up the response to extract JSON
            cleaned_content = self._clean_llm_response(content)
            structured_data = json.loads(cleaned_content)
    
            duration = time.time() - start_time
            self.metrics_collector.end_encoding(
                operation_id=operation_id,
                experience_id=experience_id,
                success=True,
                encoded_unit=structured_data,
                duration=duration
            )
    
            return structured_data
        except Exception as e:
            duration = time.time() - start_time
            self.metrics_collector.end_encoding(
                operation_id=operation_id,
                experience_id=experience_id,
                success=False,
                error=str(e),
                duration=duration
            )
>           raise RuntimeError(f"Encoding failed: {str(e)}")
E           RuntimeError: Encoding failed: Extra data: line 8 column 1 (char 317)

src/components/encode/encoder.py:189: RuntimeError

During handling of the above exception, another exception occurred:

memory_system_config = MemEvolveConfig(llm=LLMConfig(base_url='http://192.168.1.61:11434/v1', api_key='', model='', auto_resolve_models=True,...ion_log=True, max_log_size_mb=100), project_name='memevolve', project_root='.', data_dir='./data', cache_dir='./cache')
diverse_memory_units = [{'content': 'The principles of JavaScript involve design. This enables scalability.', 'id': 'lesson_02cbd912', 'metad...14:41.101900+00:00Z', 'source': 'mock_generated'}, 'tags': ['science', 'physics', 'biology', 'mathematics'], ...}, ...]

    @pytest.fixture
    def integration_test_setup(memory_system_config, diverse_memory_units):
        """Set up a complete integration test environment."""
        system = MemorySystem(memory_system_config)
    
        # Add diverse units
        for unit in diverse_memory_units:
>           system.add_experience(unit)

src/tests/conftest.py:387: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <memory_system.MemorySystem object at 0x7fb80371efc0>
experience = {'content': 'Abstracting real-world cases leads to visualizationConcept_14 which enables problem solving.', 'id': 'abs...41.101852+00:00Z', 'source': 'mock_generated'}, 'tags': ['data', 'data analysis', 'visualization', 'proficiency'], ...}

    def add_experience(self, experience: Dict[str, Any]) -> str:
        """Add a single experience to memory.
    
        This method processes a raw experience through the encoding pipeline,
        transforms it into a structured memory unit, and stores it for future retrieval.
    
        Args:
            experience: Dictionary containing experience data. Common fields:
                - "action": What was done (e.g., "searched database")
                - "result": What happened (e.g., "found relevant records")
                - "context": Additional context information
                - "timestamp": When the experience occurred
                - "metadata": Any additional relevant data
    
        Returns:
            The unique ID of the stored memory unit
    
        Raises:
            RuntimeError: If encoder or storage components are not initialized
    
        Example:
            >>> experience = {
            ...     "action": "debug code",
            ...     "result": "found null pointer exception",
            ...     "context": "C++ application",
            ...     "timestamp": "2024-01-01T10:00:00Z"
            ... }
            >>> unit_id = memory.add_experience(experience)
            >>> print(f"Stored memory unit: {unit_id}")
        """
        try:
            if not self.encoder or not self.storage:
                raise RuntimeError(
                    "Encoder and storage must be initialized"
                )
    
            encoded_unit = self.encoder.encode_experience(experience)
            unit_id = self.storage.store(encoded_unit)
    
            self._log_operation(
                "add_experience",
                {"experience_id": experience.get("id"), "unit_id": unit_id}
            )
    
            if self.config.on_encode_complete:
                self.config.on_encode_complete(unit_id, encoded_unit)
    
            self._auto_manage()
    
            return unit_id
        except Exception as e:
            self.logger.error(f"Failed to add experience: {str(e)}")
>           raise RuntimeError(f"Add experience failed: {str(e)}")
E           RuntimeError: Add experience failed: Encoding failed: Extra data: line 8 column 1 (char 317)

src/memory_system.py:303: RuntimeError
---------------------------- Captured stdout setup -----------------------------
LLM client initialized successfully at http://192.168.1.61:11434/v1
------------------------------ Captured log setup ------------------------------
WARNING  memory_unit_generator:mock_generators.py:34 Could not initialize real generator: attempted relative import beyond top-level package, falling back to mock data
ERROR    MemorySystem:memory_system.py:302 Failed to add experience: Encoding failed: Extra data: line 8 column 1 (char 317)
=================================== FAILURES ===================================
______________________ TestLLMConfig.test_default_values _______________________

self = <test_config.TestLLMConfig object at 0x7fb804898140>

    def test_default_values(self):
        config = LLMConfig()
>       assert config.base_url == ""
E       AssertionError: assert 'http://192.168.1.61:11434/v1' == ''
E         
E         + http://192.168.1.61:11434/v1

src/tests/test_config.py:34: AssertionError
_______________________ TestLLMConfig.test_custom_values _______________________

self = <test_config.TestLLMConfig object at 0x7fb8048983b0>

    def test_custom_values(self):
        # Note: Environment variables override constructor arguments
        # This test verifies that non-environment-controlled fields work
        import os
        config = LLMConfig(timeout=60, max_retries=5)
    
        # Environment-controlled fields use environment values
        assert config.base_url == os.getenv("MEMEVOLVE_LLM_BASE_URL")
        assert config.api_key == os.getenv("MEMEVOLVE_LLM_API_KEY", "")
    
        # Non-environment fields work as expected
>       assert config.timeout == 60
E       AssertionError: assert 120 == 60
E        +  where 120 = LLMConfig(base_url='http://192.168.1.61:11434/v1', api_key='', model='', auto_resolve_models=True, timeout=120, max_retries=3).timeout

src/tests/test_config.py:52: AssertionError
_____________________ TestStorageConfig.test_custom_values _____________________

self = <test_config.TestStorageConfig object at 0x7fb8048988f0>

    def test_custom_values(self):
        # Note: Environment variables override constructor arguments
        # This test verifies that non-environment-controlled fields work
        import os
        config = StorageConfig(
            backend_type="vector",
            vector_dim=1024,
            index_type="hnsw"
        )
    
        # Environment-controlled fields use environment values
        assert config.path == os.getenv("MEMEVOLVE_STORAGE_PATH", "./data/memory")
    
        # Non-environment fields work as expected
>       assert config.backend_type == "vector"
E       AssertionError: assert 'json' == 'vector'
E         
E         - vector
E         + json

src/tests/test_config.py:81: AssertionError
____________________ TestRetrievalConfig.test_custom_values ____________________

self = <test_config.TestRetrievalConfig object at 0x7fb804898e00>

    def test_custom_values(self):
        config = RetrievalConfig(
            strategy_type="semantic",
            default_top_k=10,
            semantic_weight=0.9,
            keyword_weight=0.1,
            enable_caching=False,
            cache_size=500
        )
>       assert config.strategy_type == "semantic"
E       AssertionError: assert 'hybrid' == 'semantic'
E         
E         - semantic
E         + hybrid

src/tests/test_config.py:107: AssertionError
___________________ TestManagementConfig.test_custom_values ____________________

self = <test_config.TestManagementConfig object at 0x7fb804899340>

    def test_custom_values(self):
        config = ManagementConfig(
            enable_auto_management=False,
            auto_prune_threshold=500,
            auto_consolidate_interval=50,
            deduplicate_threshold=0.8,
            forgetting_strategy="random",
            max_memory_age_days=180
        )
>       assert config.enable_auto_management is False
E       AssertionError: assert True is False
E        +  where True = ManagementConfig(enable_auto_management=True, auto_prune_threshold=1000, auto_consolidate_interval=100, deduplicate_threshold=0.9, forgetting_strategy='lru', max_memory_age_days=365).enable_auto_management

src/tests/test_config.py:136: AssertionError
_____________________ TestEncoderConfig.test_custom_values _____________________

self = <test_config.TestEncoderConfig object at 0x7fb804899850>

    def test_custom_values(self):
        config = EncoderConfig(
            encoding_strategies=["lesson", "skill", "tool"],
            enable_abstraction=False,
            abstraction_threshold=20,
            enable_tool_extraction=False
        )
>       assert config.encoding_strategies == ["lesson", "skill", "tool"]
E       AssertionError: assert ['lesson', 'skill'] == ['lesson', 'skill', 'tool']
E         
E         Right contains one more item: 'tool'
E         
E         Full diff:
E           [
E               'lesson',
E               'skill',
E         -     'tool',
E           ]

src/tests/test_config.py:161: AssertionError
____________________ TestEvolutionConfig.test_custom_values ____________________

self = <test_config.TestEvolutionConfig object at 0x7fb8048664b0>

    def test_custom_values(self):
        config = EvolutionConfig(
            population_size=20,
            generations=50,
            mutation_rate=0.2,
            crossover_rate=0.7,
            selection_method="tournament",
            tournament_size=5
        )
>       assert config.population_size == 20
E       AssertionError: assert 10 == 20
E        +  where 10 = EvolutionConfig(population_size=10, generations=20, mutation_rate=0.1, crossover_rate=0.5, selection_method='pareto', tournament_size=3).population_size

src/tests/test_config.py:188: AssertionError
____________________ TestLoggingConfig.test_default_values _____________________

self = <test_config.TestLoggingConfig object at 0x7fb804899ac0>

    def test_default_values(self):
        config = LoggingConfig()
        assert config.level == "INFO"
        assert config.format == "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
>       assert config.log_file is None
E       AssertionError: assert '' is None
E        +  where '' = LoggingConfig(level='INFO', format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', log_file='', enable_operation_log=True, max_log_size_mb=100).log_file

src/tests/test_config.py:203: AssertionError
_____________________ TestLoggingConfig.test_custom_values _____________________

self = <test_config.TestLoggingConfig object at 0x7fb8048996a0>

    def test_custom_values(self):
        config = LoggingConfig(
            level="DEBUG",
            format="%(message)s",
            log_file="app.log",
            enable_operation_log=False,
            max_log_size_mb=200
        )
>       assert config.level == "DEBUG"
E       AssertionError: assert 'INFO' == 'DEBUG'
E         
E         - DEBUG
E         + INFO

src/tests/test_config.py:215: AssertionError
__________________ TestConfigManager.test_load_from_json_file __________________

self = <test_config.TestConfigManager object at 0x7fb804899e50>

    def test_load_from_json_file(self):
        config_data = {
            "llm": {"base_url": "http://json:8080/v1", "model": "json-model"},
            "storage": {"backend_type": "vector"}
        }
    
        with tempfile.NamedTemporaryFile(mode='w', suffix='.json', delete=False) as f:
            json.dump(config_data, f)
            temp_path = f.name
    
        try:
            manager = ConfigManager(temp_path)
            # Environment variables override file settings
            import os
            assert manager.config.llm.base_url == os.getenv("MEMEVOLVE_LLM_BASE_URL")  # Env overrides
            assert manager.config.llm.model == os.getenv("MEMEVOLVE_LLM_MODEL", "json-model")  # Env overrides (empty)
>           assert manager.config.storage.backend_type == "vector"  # File setting (no env var)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E           AssertionError: assert 'json' == 'vector'
E             
E             - vector
E             + json

src/tests/test_config.py:292: AssertionError
_____________________ TestConfigManager.test_save_to_json ______________________

self = <test_config.TestConfigManager object at 0x7fb80489af60>

    def test_save_to_json(self):
        manager = ConfigManager()
        manager.update(**{"storage.backend_type": "vector"})
    
        with tempfile.NamedTemporaryFile(mode='w', suffix='.json', delete=False) as f:
            temp_path = f.name
    
        try:
            manager.save_to_file(temp_path)
            assert Path(temp_path).exists()
    
            loaded_manager = ConfigManager(temp_path)
>           assert loaded_manager.config.storage.backend_type == "vector"
E           AssertionError: assert 'json' == 'vector'
E             
E             - vector
E             + json

src/tests/test_config.py:363: AssertionError
__________________________ test_generate_abstraction ___________________________

self = <components.encode.encoder.ExperienceEncoder object at 0x7fb80371c890>
experience = {'content': 'Python is a programming language', 'id': 'exp_001', 'type': 'lesson'}

    def encode_experience(self, experience: Dict[str, Any]) -> Dict[str, Any]:
        if self.client is None:
            raise RuntimeError(
                "LLM client not initialized. Call initialize_llm() first.")
    
        experience_id = experience.get("id", "unknown")
        operation_id = self.metrics_collector.start_encoding(experience_id)
        start_time = time.time()
    
        prompt = (
            "Transform this raw experience into a structured knowledge "
            "unit:\n\n"
            f"Experience:\n{json.dumps(experience, indent=2)}\n\n"
            "Format your response as JSON with these fields:\n"
            '- "type": "lesson" (generalizable insight), "skill" (actionable technique), '
            '"tool" (reusable function/algorithm), "abstraction" (high-level concept)\n'
            '- "content": The transformed content\n'
            '- "metadata": Additional relevant metadata (for tools: include parameters, usage, etc.)\n'
            '- "tags": Relevant tags for retrieval\n\n'
            "For tools, focus on extracting reusable functionality that can be applied to similar problems.\n\n"
            "Example output formats:\n"
            '{\n  "type": "lesson",\n  "content": "Always validate input data before processing",\n  '
            '"metadata": {},\n  "tags": ["data-validation", "best-practices"]\n}\n\n'
            '{\n  "type": "tool",\n  "content": "Binary search algorithm for finding elements in sorted arrays",\n  '
            '"metadata": {"parameters": ["array", "target"], "complexity": "O(log n)"},\n  '
            '"tags": ["algorithm", "search", "binary-search"]\n}'
        )
    
        try:
            kwargs = {
                "messages": [{"role": "user", "content": prompt}],
                "max_tokens": 512,
                "temperature": 0.7,
                "timeout": 300.0
            }
    
            if self.model is not None:
                kwargs["model"] = self.model
    
            response = self.client.chat.completions.create(**kwargs)
            content = response.choices[0].message.content
            if content is None:
                raise RuntimeError("Empty response from LLM")
    
            # Clean up the response to extract JSON
            cleaned_content = self._clean_llm_response(content)
>           structured_data = json.loads(cleaned_content)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^

src/components/encode/encoder.py:168: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/usr/lib/python3.12/json/__init__.py:346: in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/json/decoder.py:337: in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <json.decoder.JSONDecoder object at 0x7fb81f29fce0>
s = '{\n  "type": "lesson",\n  "content": "Python is a programming language that enables developers to write scripts and a...for": "Beginners exploring scripting"\n  },\n  "tags": ["programming-intro", "language-learning", "code-execution"]\n}'
idx = 0

    def raw_decode(self, s, idx=0):
        """Decode a JSON document from ``s`` (a ``str`` beginning with
        a JSON document) and return a 2-tuple of the Python
        representation and the index in ``s`` where the document ended.
    
        This can be used to decode a JSON document from a string that may
        have extraneous data at the end.
    
        """
        try:
>           obj, end = self.scan_once(s, idx)
                       ^^^^^^^^^^^^^^^^^^^^^^
E           json.decoder.JSONDecodeError: Expecting ',' delimiter: line 16 column 1 (char 574)

/usr/lib/python3.12/json/decoder.py:353: JSONDecodeError

During handling of the above exception, another exception occurred:

self = <memory_system.MemorySystem object at 0x7fb80371cd10>
experience = {'content': 'Python is a programming language', 'id': 'exp_001', 'type': 'lesson'}

    def add_experience(self, experience: Dict[str, Any]) -> str:
        """Add a single experience to memory.
    
        This method processes a raw experience through the encoding pipeline,
        transforms it into a structured memory unit, and stores it for future retrieval.
    
        Args:
            experience: Dictionary containing experience data. Common fields:
                - "action": What was done (e.g., "searched database")
                - "result": What happened (e.g., "found relevant records")
                - "context": Additional context information
                - "timestamp": When the experience occurred
                - "metadata": Any additional relevant data
    
        Returns:
            The unique ID of the stored memory unit
    
        Raises:
            RuntimeError: If encoder or storage components are not initialized
    
        Example:
            >>> experience = {
            ...     "action": "debug code",
            ...     "result": "found null pointer exception",
            ...     "context": "C++ application",
            ...     "timestamp": "2024-01-01T10:00:00Z"
            ... }
            >>> unit_id = memory.add_experience(experience)
            >>> print(f"Stored memory unit: {unit_id}")
        """
        try:
            if not self.encoder or not self.storage:
                raise RuntimeError(
                    "Encoder and storage must be initialized"
                )
    
>           encoded_unit = self.encoder.encode_experience(experience)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

src/memory_system.py:287: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <components.encode.encoder.ExperienceEncoder object at 0x7fb80371c890>
experience = {'content': 'Python is a programming language', 'id': 'exp_001', 'type': 'lesson'}

    def encode_experience(self, experience: Dict[str, Any]) -> Dict[str, Any]:
        if self.client is None:
            raise RuntimeError(
                "LLM client not initialized. Call initialize_llm() first.")
    
        experience_id = experience.get("id", "unknown")
        operation_id = self.metrics_collector.start_encoding(experience_id)
        start_time = time.time()
    
        prompt = (
            "Transform this raw experience into a structured knowledge "
            "unit:\n\n"
            f"Experience:\n{json.dumps(experience, indent=2)}\n\n"
            "Format your response as JSON with these fields:\n"
            '- "type": "lesson" (generalizable insight), "skill" (actionable technique), '
            '"tool" (reusable function/algorithm), "abstraction" (high-level concept)\n'
            '- "content": The transformed content\n'
            '- "metadata": Additional relevant metadata (for tools: include parameters, usage, etc.)\n'
            '- "tags": Relevant tags for retrieval\n\n'
            "For tools, focus on extracting reusable functionality that can be applied to similar problems.\n\n"
            "Example output formats:\n"
            '{\n  "type": "lesson",\n  "content": "Always validate input data before processing",\n  '
            '"metadata": {},\n  "tags": ["data-validation", "best-practices"]\n}\n\n'
            '{\n  "type": "tool",\n  "content": "Binary search algorithm for finding elements in sorted arrays",\n  '
            '"metadata": {"parameters": ["array", "target"], "complexity": "O(log n)"},\n  '
            '"tags": ["algorithm", "search", "binary-search"]\n}'
        )
    
        try:
            kwargs = {
                "messages": [{"role": "user", "content": prompt}],
                "max_tokens": 512,
                "temperature": 0.7,
                "timeout": 300.0
            }
    
            if self.model is not None:
                kwargs["model"] = self.model
    
            response = self.client.chat.completions.create(**kwargs)
            content = response.choices[0].message.content
            if content is None:
                raise RuntimeError("Empty response from LLM")
    
            # Clean up the response to extract JSON
            cleaned_content = self._clean_llm_response(content)
            structured_data = json.loads(cleaned_content)
    
            duration = time.time() - start_time
            self.metrics_collector.end_encoding(
                operation_id=operation_id,
                experience_id=experience_id,
                success=True,
                encoded_unit=structured_data,
                duration=duration
            )
    
            return structured_data
        except Exception as e:
            duration = time.time() - start_time
            self.metrics_collector.end_encoding(
                operation_id=operation_id,
                experience_id=experience_id,
                success=False,
                error=str(e),
                duration=duration
            )
>           raise RuntimeError(f"Encoding failed: {str(e)}")
E           RuntimeError: Encoding failed: Expecting ',' delimiter: line 16 column 1 (char 574)

src/components/encode/encoder.py:189: RuntimeError

During handling of the above exception, another exception occurred:

memory_system = <memory_system.MemorySystem object at 0x7fb80371cd10>

    def test_generate_abstraction(memory_system):
>       memory_system.add_experience({
            "id": "exp_001",
            "content": "Python is a programming language",
            "type": "lesson"
        })

src/tests/test_memory_system.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <memory_system.MemorySystem object at 0x7fb80371cd10>
experience = {'content': 'Python is a programming language', 'id': 'exp_001', 'type': 'lesson'}

    def add_experience(self, experience: Dict[str, Any]) -> str:
        """Add a single experience to memory.
    
        This method processes a raw experience through the encoding pipeline,
        transforms it into a structured memory unit, and stores it for future retrieval.
    
        Args:
            experience: Dictionary containing experience data. Common fields:
                - "action": What was done (e.g., "searched database")
                - "result": What happened (e.g., "found relevant records")
                - "context": Additional context information
                - "timestamp": When the experience occurred
                - "metadata": Any additional relevant data
    
        Returns:
            The unique ID of the stored memory unit
    
        Raises:
            RuntimeError: If encoder or storage components are not initialized
    
        Example:
            >>> experience = {
            ...     "action": "debug code",
            ...     "result": "found null pointer exception",
            ...     "context": "C++ application",
            ...     "timestamp": "2024-01-01T10:00:00Z"
            ... }
            >>> unit_id = memory.add_experience(experience)
            >>> print(f"Stored memory unit: {unit_id}")
        """
        try:
            if not self.encoder or not self.storage:
                raise RuntimeError(
                    "Encoder and storage must be initialized"
                )
    
            encoded_unit = self.encoder.encode_experience(experience)
            unit_id = self.storage.store(encoded_unit)
    
            self._log_operation(
                "add_experience",
                {"experience_id": experience.get("id"), "unit_id": unit_id}
            )
    
            if self.config.on_encode_complete:
                self.config.on_encode_complete(unit_id, encoded_unit)
    
            self._auto_manage()
    
            return unit_id
        except Exception as e:
            self.logger.error(f"Failed to add experience: {str(e)}")
>           raise RuntimeError(f"Add experience failed: {str(e)}")
E           RuntimeError: Add experience failed: Encoding failed: Expecting ',' delimiter: line 16 column 1 (char 574)

src/memory_system.py:303: RuntimeError
---------------------------- Captured stdout setup -----------------------------
LLM client initialized successfully at http://192.168.1.61:11434/v1
Auto-detected model: unsloth_LFM2.5-1.2B-Instruct-GGUF_LFM2.5-1.2B-Instruct-BF16.gguf
Encoder initialized
Storage backend configured
Retrieval strategy configured
Memory manager configured
All components initialized successfully
------------------------------ Captured log setup ------------------------------
INFO     MemorySystem:memory_system.py:203 Encoder initialized
INFO     MemorySystem:memory_system.py:209 Storage backend configured
INFO     MemorySystem:memory_system.py:227 Retrieval strategy configured
INFO     MemorySystem:memory_system.py:240 Memory manager configured
INFO     MemorySystem:memory_system.py:184 All components initialized successfully
----------------------------- Captured stdout call -----------------------------
HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
Failed to add experience: Encoding failed: Expecting ',' delimiter: line 16 column 1 (char 574)
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
ERROR    MemorySystem:memory_system.py:302 Failed to add experience: Encoding failed: Expecting ',' delimiter: line 16 column 1 (char 574)
______________________________ test_manage_prune _______________________________

memory_system = <memory_system.MemorySystem object at 0x7fb80376d190>

    def test_manage_prune(memory_system):
        for i in range(10):
            memory_system.add_experience({
                "id": f"exp_{i}",
                "type": "lesson" if i % 2 == 0 else "skill",
                "content": f"Test content {i}"
            })
    
        initial_count = memory_system.storage.count()
        memory_system.manage_memory("prune", criteria={"type": "skill"})
    
        final_count = memory_system.storage.count()
>       assert final_count < initial_count
E       assert 10 < 10

src/tests/test_memory_system.py:202: AssertionError
---------------------------- Captured stdout setup -----------------------------
LLM client initialized successfully at http://192.168.1.61:11434/v1
Auto-detected model: unsloth_LFM2.5-1.2B-Instruct-GGUF_LFM2.5-1.2B-Instruct-BF16.gguf
Encoder initialized
Storage backend configured
Retrieval strategy configured
Memory manager configured
All components initialized successfully
------------------------------ Captured log setup ------------------------------
INFO     MemorySystem:memory_system.py:203 Encoder initialized
INFO     MemorySystem:memory_system.py:209 Storage backend configured
INFO     MemorySystem:memory_system.py:227 Retrieval strategy configured
INFO     MemorySystem:memory_system.py:240 Memory manager configured
INFO     MemorySystem:memory_system.py:184 All components initialized successfully
----------------------------- Captured stdout call -----------------------------
HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
___________________________ test_manage_consolidate ____________________________

self = <components.encode.encoder.ExperienceEncoder object at 0x7fb80376c680>
experience = {'content': 'Test lesson 1', 'id': 'exp_001', 'type': 'lesson'}

    def encode_experience(self, experience: Dict[str, Any]) -> Dict[str, Any]:
        if self.client is None:
            raise RuntimeError(
                "LLM client not initialized. Call initialize_llm() first.")
    
        experience_id = experience.get("id", "unknown")
        operation_id = self.metrics_collector.start_encoding(experience_id)
        start_time = time.time()
    
        prompt = (
            "Transform this raw experience into a structured knowledge "
            "unit:\n\n"
            f"Experience:\n{json.dumps(experience, indent=2)}\n\n"
            "Format your response as JSON with these fields:\n"
            '- "type": "lesson" (generalizable insight), "skill" (actionable technique), '
            '"tool" (reusable function/algorithm), "abstraction" (high-level concept)\n'
            '- "content": The transformed content\n'
            '- "metadata": Additional relevant metadata (for tools: include parameters, usage, etc.)\n'
            '- "tags": Relevant tags for retrieval\n\n'
            "For tools, focus on extracting reusable functionality that can be applied to similar problems.\n\n"
            "Example output formats:\n"
            '{\n  "type": "lesson",\n  "content": "Always validate input data before processing",\n  '
            '"metadata": {},\n  "tags": ["data-validation", "best-practices"]\n}\n\n'
            '{\n  "type": "tool",\n  "content": "Binary search algorithm for finding elements in sorted arrays",\n  '
            '"metadata": {"parameters": ["array", "target"], "complexity": "O(log n)"},\n  '
            '"tags": ["algorithm", "search", "binary-search"]\n}'
        )
    
        try:
            kwargs = {
                "messages": [{"role": "user", "content": prompt}],
                "max_tokens": 512,
                "temperature": 0.7,
                "timeout": 300.0
            }
    
            if self.model is not None:
                kwargs["model"] = self.model
    
            response = self.client.chat.completions.create(**kwargs)
            content = response.choices[0].message.content
            if content is None:
                raise RuntimeError("Empty response from LLM")
    
            # Clean up the response to extract JSON
            cleaned_content = self._clean_llm_response(content)
>           structured_data = json.loads(cleaned_content)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^

src/components/encode/encoder.py:168: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/usr/lib/python3.12/json/__init__.py:346: in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <json.decoder.JSONDecoder object at 0x7fb81f29fce0>
s = '{\n  "type": "lesson",\n  "content": "Test lesson 1",\n  "metadata": {\n    "parameters": ["array", "target"],\n    "...": ["id", "type"],\n    "version": "1.0"\n  },\n  "tags": ["lesson-learning", "algorithm-intro", "data-processing"]\n}'
_w = <built-in method match of re.Pattern object at 0x7fb81f2569b0>

    def decode(self, s, _w=WHITESPACE.match):
        """Return the Python representation of ``s`` (a ``str`` instance
        containing a JSON document).
    
        """
        obj, end = self.raw_decode(s, idx=_w(s, 0).end())
        end = _w(s, end).end()
        if end != len(s):
>           raise JSONDecodeError("Extra data", s, end)
E           json.decoder.JSONDecodeError: Extra data: line 17 column 2 (char 581)

/usr/lib/python3.12/json/decoder.py:340: JSONDecodeError

During handling of the above exception, another exception occurred:

self = <memory_system.MemorySystem object at 0x7fb80376f4a0>
experience = {'content': 'Test lesson 1', 'id': 'exp_001', 'type': 'lesson'}

    def add_experience(self, experience: Dict[str, Any]) -> str:
        """Add a single experience to memory.
    
        This method processes a raw experience through the encoding pipeline,
        transforms it into a structured memory unit, and stores it for future retrieval.
    
        Args:
            experience: Dictionary containing experience data. Common fields:
                - "action": What was done (e.g., "searched database")
                - "result": What happened (e.g., "found relevant records")
                - "context": Additional context information
                - "timestamp": When the experience occurred
                - "metadata": Any additional relevant data
    
        Returns:
            The unique ID of the stored memory unit
    
        Raises:
            RuntimeError: If encoder or storage components are not initialized
    
        Example:
            >>> experience = {
            ...     "action": "debug code",
            ...     "result": "found null pointer exception",
            ...     "context": "C++ application",
            ...     "timestamp": "2024-01-01T10:00:00Z"
            ... }
            >>> unit_id = memory.add_experience(experience)
            >>> print(f"Stored memory unit: {unit_id}")
        """
        try:
            if not self.encoder or not self.storage:
                raise RuntimeError(
                    "Encoder and storage must be initialized"
                )
    
>           encoded_unit = self.encoder.encode_experience(experience)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

src/memory_system.py:287: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <components.encode.encoder.ExperienceEncoder object at 0x7fb80376c680>
experience = {'content': 'Test lesson 1', 'id': 'exp_001', 'type': 'lesson'}

    def encode_experience(self, experience: Dict[str, Any]) -> Dict[str, Any]:
        if self.client is None:
            raise RuntimeError(
                "LLM client not initialized. Call initialize_llm() first.")
    
        experience_id = experience.get("id", "unknown")
        operation_id = self.metrics_collector.start_encoding(experience_id)
        start_time = time.time()
    
        prompt = (
            "Transform this raw experience into a structured knowledge "
            "unit:\n\n"
            f"Experience:\n{json.dumps(experience, indent=2)}\n\n"
            "Format your response as JSON with these fields:\n"
            '- "type": "lesson" (generalizable insight), "skill" (actionable technique), '
            '"tool" (reusable function/algorithm), "abstraction" (high-level concept)\n'
            '- "content": The transformed content\n'
            '- "metadata": Additional relevant metadata (for tools: include parameters, usage, etc.)\n'
            '- "tags": Relevant tags for retrieval\n\n'
            "For tools, focus on extracting reusable functionality that can be applied to similar problems.\n\n"
            "Example output formats:\n"
            '{\n  "type": "lesson",\n  "content": "Always validate input data before processing",\n  '
            '"metadata": {},\n  "tags": ["data-validation", "best-practices"]\n}\n\n'
            '{\n  "type": "tool",\n  "content": "Binary search algorithm for finding elements in sorted arrays",\n  '
            '"metadata": {"parameters": ["array", "target"], "complexity": "O(log n)"},\n  '
            '"tags": ["algorithm", "search", "binary-search"]\n}'
        )
    
        try:
            kwargs = {
                "messages": [{"role": "user", "content": prompt}],
                "max_tokens": 512,
                "temperature": 0.7,
                "timeout": 300.0
            }
    
            if self.model is not None:
                kwargs["model"] = self.model
    
            response = self.client.chat.completions.create(**kwargs)
            content = response.choices[0].message.content
            if content is None:
                raise RuntimeError("Empty response from LLM")
    
            # Clean up the response to extract JSON
            cleaned_content = self._clean_llm_response(content)
            structured_data = json.loads(cleaned_content)
    
            duration = time.time() - start_time
            self.metrics_collector.end_encoding(
                operation_id=operation_id,
                experience_id=experience_id,
                success=True,
                encoded_unit=structured_data,
                duration=duration
            )
    
            return structured_data
        except Exception as e:
            duration = time.time() - start_time
            self.metrics_collector.end_encoding(
                operation_id=operation_id,
                experience_id=experience_id,
                success=False,
                error=str(e),
                duration=duration
            )
>           raise RuntimeError(f"Encoding failed: {str(e)}")
E           RuntimeError: Encoding failed: Extra data: line 17 column 2 (char 581)

src/components/encode/encoder.py:189: RuntimeError

During handling of the above exception, another exception occurred:

memory_system = <memory_system.MemorySystem object at 0x7fb80376f4a0>

    def test_manage_consolidate(memory_system):
>       memory_system.add_experience({
            "id": "exp_001",
            "type": "lesson",
            "content": "Test lesson 1"
        })

src/tests/test_memory_system.py:206: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <memory_system.MemorySystem object at 0x7fb80376f4a0>
experience = {'content': 'Test lesson 1', 'id': 'exp_001', 'type': 'lesson'}

    def add_experience(self, experience: Dict[str, Any]) -> str:
        """Add a single experience to memory.
    
        This method processes a raw experience through the encoding pipeline,
        transforms it into a structured memory unit, and stores it for future retrieval.
    
        Args:
            experience: Dictionary containing experience data. Common fields:
                - "action": What was done (e.g., "searched database")
                - "result": What happened (e.g., "found relevant records")
                - "context": Additional context information
                - "timestamp": When the experience occurred
                - "metadata": Any additional relevant data
    
        Returns:
            The unique ID of the stored memory unit
    
        Raises:
            RuntimeError: If encoder or storage components are not initialized
    
        Example:
            >>> experience = {
            ...     "action": "debug code",
            ...     "result": "found null pointer exception",
            ...     "context": "C++ application",
            ...     "timestamp": "2024-01-01T10:00:00Z"
            ... }
            >>> unit_id = memory.add_experience(experience)
            >>> print(f"Stored memory unit: {unit_id}")
        """
        try:
            if not self.encoder or not self.storage:
                raise RuntimeError(
                    "Encoder and storage must be initialized"
                )
    
            encoded_unit = self.encoder.encode_experience(experience)
            unit_id = self.storage.store(encoded_unit)
    
            self._log_operation(
                "add_experience",
                {"experience_id": experience.get("id"), "unit_id": unit_id}
            )
    
            if self.config.on_encode_complete:
                self.config.on_encode_complete(unit_id, encoded_unit)
    
            self._auto_manage()
    
            return unit_id
        except Exception as e:
            self.logger.error(f"Failed to add experience: {str(e)}")
>           raise RuntimeError(f"Add experience failed: {str(e)}")
E           RuntimeError: Add experience failed: Encoding failed: Extra data: line 17 column 2 (char 581)

src/memory_system.py:303: RuntimeError
---------------------------- Captured stdout setup -----------------------------
LLM client initialized successfully at http://192.168.1.61:11434/v1
Auto-detected model: unsloth_LFM2.5-1.2B-Instruct-GGUF_LFM2.5-1.2B-Instruct-BF16.gguf
Encoder initialized
Storage backend configured
Retrieval strategy configured
Memory manager configured
All components initialized successfully
------------------------------ Captured log setup ------------------------------
INFO     MemorySystem:memory_system.py:203 Encoder initialized
INFO     MemorySystem:memory_system.py:209 Storage backend configured
INFO     MemorySystem:memory_system.py:227 Retrieval strategy configured
INFO     MemorySystem:memory_system.py:240 Memory manager configured
INFO     MemorySystem:memory_system.py:184 All components initialized successfully
----------------------------- Captured stdout call -----------------------------
HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
Failed to add experience: Encoding failed: Extra data: line 17 column 2 (char 581)
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://192.168.1.61:11434/v1/chat/completions "HTTP/1.1 200 OK"
ERROR    MemorySystem:memory_system.py:302 Failed to add experience: Encoding failed: Extra data: line 17 column 2 (char 581)
=============================== warnings summary ===============================
src/utils/mock_generators.py:417
  /home/phil/opencode/memevolve/src/utils/mock_generators.py:417: PytestCollectionWarning: cannot collect test class 'TestScenarioGenerator' because it has a __init__ constructor (from: src/tests/test_mock_generators.py)
    class TestScenarioGenerator:

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED src/tests/test_config.py::TestLLMConfig::test_default_values - Asserti...
FAILED src/tests/test_config.py::TestLLMConfig::test_custom_values - Assertio...
FAILED src/tests/test_config.py::TestStorageConfig::test_custom_values - Asse...
FAILED src/tests/test_config.py::TestRetrievalConfig::test_custom_values - As...
FAILED src/tests/test_config.py::TestManagementConfig::test_custom_values - A...
FAILED src/tests/test_config.py::TestEncoderConfig::test_custom_values - Asse...
FAILED src/tests/test_config.py::TestEvolutionConfig::test_custom_values - As...
FAILED src/tests/test_config.py::TestLoggingConfig::test_default_values - Ass...
FAILED src/tests/test_config.py::TestLoggingConfig::test_custom_values - Asse...
FAILED src/tests/test_config.py::TestConfigManager::test_load_from_json_file
FAILED src/tests/test_config.py::TestConfigManager::test_save_to_json - Asser...
FAILED src/tests/test_memory_system.py::test_generate_abstraction - RuntimeEr...
FAILED src/tests/test_memory_system.py::test_manage_prune - assert 10 < 10
FAILED src/tests/test_memory_system.py::test_manage_consolidate - RuntimeErro...
ERROR src/tests/test_fixture_tests.py::test_integration_test_setup_fixture - ...
======== 14 failed, 377 passed, 1 warning, 1 error in 688.52s (0:11:28) ========
