# MemEvolve Environment Configuration
# Copy this file to .env and update values for your environment

# =============================================================================
# API ENDPOINTS - LLM Services Configuration
# =============================================================================

# Upstream LLM API (REQUIRED)
# Your primary OpenAI-compatible LLM service
MEMEVOLVE_UPSTREAM_BASE_URL=
MEMEVOLVE_UPSTREAM_API_KEY=
MEMEVOLVE_UPSTREAM_MODEL=
MEMEVOLVE_UPSTREAM_AUTO_RESOLVE_MODELS=true
MEMEVOLVE_UPSTREAM_TIMEOUT=720

# Embedding API (OPTIONAL)
# Separate embedding service if different from upstream
MEMEVOLVE_EMBEDDING_BASE_URL=
MEMEVOLVE_EMBEDDING_API_KEY=
MEMEVOLVE_EMBEDDING_MODEL=
MEMEVOLVE_EMBEDDING_AUTO_RESOLVE_MODELS=true
MEMEVOLVE_EMBEDDING_TIMEOUT=60
MEMEVOLVE_EMBEDDING_MAX_TOKENS=
MEMEVOLVE_EMBEDDING_DIMENSION=

# Memory LLM API (OPTIONAL)
# Dedicated LLM for memory encoding operations
MEMEVOLVE_MEMORY_BASE_URL=
MEMEVOLVE_MEMORY_API_KEY=
MEMEVOLVE_MEMORY_MODEL=
MEMEVOLVE_MEMORY_AUTO_RESOLVE_MODELS=true
MEMEVOLVE_MEMORY_TIMEOUT=120

# =============================================================================
# GLOBAL API SETTINGS
# =============================================================================

# Applied to all API endpoints
MEMEVOLVE_API_MAX_RETRIES=3
MEMEVOLVE_DEFAULT_TOP_K=3

# =============================================================================
# API SERVER CONFIGURATION
# =============================================================================

MEMEVOLVE_API_ENABLE=true
MEMEVOLVE_API_HOST=127.0.0.1
MEMEVOLVE_API_PORT=11436
MEMEVOLVE_API_MEMORY_INTEGRATION=true

# =============================================================================
# STORAGE & DATA MANAGEMENT
# =============================================================================

# Data directories
MEMEVOLVE_DATA_DIR=./data
MEMEVOLVE_CACHE_DIR=./cache
MEMEVOLVE_LOGS_DIR=./logs

# Storage backend
MEMEVOLVE_STORAGE_BACKEND_TYPE=vector
MEMEVOLVE_STORAGE_INDEX_TYPE=ivf

# Neo4j connection (only when using graph storage backend)
MEMEVOLVE_NEO4J_URI=bolt://localhost:7687
MEMEVOLVE_NEO4J_USER=neo4j
MEMEVOLVE_NEO4J_PASSWORD=password
MEMEVOLVE_NEO4J_TIMEOUT=30
MEMEVOLVE_NEO4J_MAX_RETRIES=3

# =============================================================================
# MEMORY SYSTEM BEHAVIOR
# =============================================================================

# Memory injection relevance filtering
MEMEVOLVE_MEMORY_RELEVANCE_THRESHOLD=0.5

# Retrieval settings
MEMEVOLVE_RETRIEVAL_STRATEGY_TYPE=hybrid
MEMEVOLVE_RETRIEVAL_TOP_K=3
MEMEVOLVE_RETRIEVAL_SEMANTIC_WEIGHT=0.7
MEMEVOLVE_RETRIEVAL_KEYWORD_WEIGHT=0.3
MEMEVOLVE_RETRIEVAL_ENABLE_CACHING=true
MEMEVOLVE_RETRIEVAL_CACHE_SIZE=1024

# Evolution-managed retrieval parameters (synced from genotype)
MEMEVOLVE_RETRIEVAL_SIMILARITY_THRESHOLD=0.7
MEMEVOLVE_RETRIEVAL_ENABLE_FILTERS=true
MEMEVOLVE_RETRIEVAL_SEMANTIC_CACHE_ENABLED=true
MEMEVOLVE_RETRIEVAL_KEYWORD_CASE_SENSITIVE=false
MEMEVOLVE_RETRIEVAL_SEMANTIC_EMBEDDING_MODEL=
MEMEVOLVE_RETRIEVAL_HYBRID_SEMANTIC_WEIGHT=0.7
MEMEVOLVE_RETRIEVAL_HYBRID_KEYWORD_WEIGHT=0.3

# Memory management
MEMEVOLVE_MANAGEMENT_ENABLE_AUTO_MANAGEMENT=true
MEMEVOLVE_MANAGEMENT_AUTO_PRUNE_THRESHOLD=8192
MEMEVOLVE_MANAGEMENT_AUTO_CONSOLIDATE_INTERVAL=128
MEMEVOLVE_MANAGEMENT_DEDUPLICATE_THRESHOLD=0.9
MEMEVOLVE_MANAGEMENT_FORGETTING_STRATEGY=lru
MEMEVOLVE_MANAGEMENT_MAX_MEMORY_AGE_DAYS=365

# User-configurable management parameters (not evolved)
MEMEVOLVE_MANAGEMENT_STRATEGY_TYPE=simple
MEMEVOLVE_MANAGEMENT_PRUNE_MAX_AGE_DAYS=365
MEMEVOLVE_MANAGEMENT_PRUNE_MAX_COUNT=8192
MEMEVOLVE_MANAGEMENT_PRUNE_BY_TYPE=
MEMEVOLVE_MANAGEMENT_CONSOLIDATE_ENABLED=true
MEMEVOLVE_MANAGEMENT_CONSOLIDATE_MIN_UNITS=2
MEMEVOLVE_MANAGEMENT_DEDUPLICATE_ENABLED=true
MEMEVOLVE_MANAGEMENT_DEDUPLICATE_SIMILARITY_THRESHOLD=0.9
MEMEVOLVE_MANAGEMENT_FORGETTING_PERCENTAGE=0.1

# Management mutation parameters (only when evolution is enabled)
MEMEVOLVE_MUTATION_MANAGEMENT_STRATEGIES=simple,advanced
MEMEVOLVE_MUTATION_FORGETTING_STRATEGIES=lru,lfu,random,cost_based
MEMEVOLVE_MUTATION_FORGETTING_PERCENTAGE_MIN=0.05
MEMEVOLVE_MUTATION_FORGETTING_PERCENTAGE_MAX=0.3
MEMEVOLVE_MUTATION_COST_THRESHOLD_MIN=0.8
MEMEVOLVE_MUTATION_COST_THRESHOLD_MAX=0.95
MEMEVOLVE_MUTATION_STRATEGY_ADDITION_PROBABILITY=0.5
MEMEVOLVE_MUTATION_TEMPERATURE_DELTA=0.1

# Memory encoding
MEMEVOLVE_ENCODER_ENCODING_STRATEGIES=lesson,skill,tool,abstraction
MEMEVOLVE_ENCODER_ENABLE_ABSTRACTIONS=true
MEMEVOLVE_ENCODER_ENABLE_TOOL_EXTRACTION=true
MEMEVOLVE_ENCODER_ABSTRACTION_THRESHOLD=10

# Evolution-managed encoder parameters (synced from genotype)
MEMEVOLVE_ENCODER_MAX_TOKENS=512
MEMEVOLVE_ENCODER_BATCH_SIZE=10
MEMEVOLVE_ENCODER_TEMPERATURE=0.7
MEMEVOLVE_ENCODER_LLM_MODEL=
MEMEVOLVE_ENCODER_MIN_ABSTRACTION_UNITS=3

# Memory Encoding Prompts (fixes verbose prefixes)
MEMEVOLVE_CHUNK_PROCESSING_INSTRUCTION=Extract key insight from this experience chunk as JSON.
MEMEVOLVE_CHUNK_CONTENT_INSTRUCTION=Focus on the specific action, insight, or learning from this chunk.
MEMEVOLVE_CHUNK_STRUCTURE_EXAMPLE={"type": "lesson", "content": "Specific insight", "metadata": {"chunk_index": 0}, "tags": ["relevant"]}

MEMEVOLVE_ENCODING_INSTRUCTION=Extract the most important insight from this experience as JSON.
MEMEVOLVE_CONTENT_INSTRUCTION=Return the core action, decision, or learning in 1-2 sentences.
MEMEVOLVE_STRUCTURE_EXAMPLE={"type": "lesson", "content": "Specific action learned", "metadata": {}, "tags": ["relevant"]}

# Encoding Type Descriptions (configurable)
MEMEVOLVE_TYPE_DESCRIPTIONS=lesson:generalizable insight,skill:actionable technique,tool:reusable function/algorithm,abstraction:high-level concept

# =============================================================================
# ADVANCED SETTINGS
# =============================================================================

# Memory Evolution (Advanced feature)
MEMEVOLVE_ENABLE_EVOLUTION=true

# Evolution parameters (only when evolution is enabled)
MEMEVOLVE_EVOLUTION_POPULATION_SIZE=10
MEMEVOLVE_EVOLUTION_GENERATIONS=20
MEMEVOLVE_EVOLUTION_MUTATION_RATE=0.1
MEMEVOLVE_EVOLUTION_CROSSOVER_RATE=0.5
MEMEVOLVE_EVOLUTION_SELECTION_METHOD=pareto
MEMEVOLVE_EVOLUTION_TOURNAMENT_SIZE=3

# Fitness weights (only when evolution is enabled)
MEMEVOLVE_FITNESS_WEIGHT_SUCCESS=1.0
MEMEVOLVE_FITNESS_WEIGHT_TOKENS=0.1
MEMEVOLVE_FITNESS_WEIGHT_TIME=0.001
MEMEVOLVE_FITNESS_WEIGHT_RETRIEVAL=0.5

# Evolution Parameter Boundaries (all fallbacks in config.py)
MEMEVOLVE_MAX_TOKENS_MIN=256
MEMEVOLVE_MAX_TOKENS_MAX=4096
MEMEVOLVE_TOP_K_MIN=2
MEMEVOLVE_TOP_K_MAX=10
MEMEVOLVE_SIMILARITY_THRESHOLD_MIN=0.5
MEMEVOLVE_SIMILARITY_THRESHOLD_MAX=0.95
MEMEVOLVE_TEMPERATURE_MIN=0.0
MEMEVOLVE_TEMPERATURE_MAX=1.0
MEMEVOLVE_MIN_REQUESTS_PER_CYCLE=32
MEMEVOLVE_FITNESS_HISTORY_SIZE=64

# Evolution Mutation Options (only when evolution is enabled)
MEMEVOLVE_MUTATION_RETRIEVAL_STRATEGIES=keyword,semantic,hybrid,llm_guided
MEMEVOLVE_MUTATION_HYBRID_WEIGHT_MIN=0.0
MEMEVOLVE_MUTATION_HYBRID_WEIGHT_MAX=1.0
MEMEVOLVE_MUTATION_ENCODING_STRATEGIES=lesson|skill|tool|abstraction|lesson,skill|lesson,tool|lesson,abstraction|skill,tool|skill,abstraction|tool,abstraction|lesson,skill,tool|lesson,skill,abstraction|lesson,tool,abstraction|skill,tool,abstraction|lesson,skill,tool,abstraction
MEMEVOLVE_MUTATION_BATCH_SIZE_MIN=5
MEMEVOLVE_MUTATION_BATCH_SIZE_MULTIPLIER=2.0
MEMEVOLVE_MUTATION_TOKEN_STEP_SIZE=256

# Auto-Evolution Triggers (intelligent automatic evolution)
MEMEVOLVE_AUTO_EVOLUTION_ENABLED=true
MEMEVOLVE_AUTO_EVOLUTION_REQUESTS=32
MEMEVOLVE_AUTO_EVOLUTION_DEGRADATION=0.2
MEMEVOLVE_AUTO_EVOLUTION_PLATEAU=5
MEMEVOLVE_AUTO_EVOLUTION_HOURS=24
MEMEVOLVE_AUTO_EVOLUTION_CYCLE_SECONDS=1800

# Logging Configuration
MEMEVOLVE_LOG_LEVEL=DEBUG
MEMEVOLVE_LOGGING_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
MEMEVOLVE_LOGGING_MAX_LOG_SIZE_MB=1024

# Component-specific logging (controls where events are routed)
MEMEVOLVE_LOG_API_SERVER_ENABLE=true
MEMEVOLVE_LOG_MIDDLEWARE_ENABLE=true
MEMEVOLVE_LOG_MEMORY_ENABLE=true
MEMEVOLVE_LOG_EVOLUTION_ENABLE=true
MEMEVOLVE_LOG_MEMEVOLVE_ENABLE=true
MEMEVOLVE_LOG_OPERATION_ENABLE=true

# Project settings (rarely changed)
MEMEVOLVE_PROJECT_NAME=MemEvolve-API
MEMEVOLVE_PROJECT_ROOT=.
